window.JSON||(window.JSON={parse:function(sJSON){return eval("("+sJSON+")")}}),!function(t,e,s){"undefined"!=typeof module&&module.exports?module.exports=s():"function"==typeof define&&define.amd?define(s):e[t]=s()}("reqwest",this,function(){function succeed(t){var e=protocolRe.exec(t.url);return e=e&&e[1]||window.location.protocol,httpsRe.test(e)?twoHundo.test(t.request.status):!!t.request.response}function handleReadyState(t,e,s){return function(){return t._aborted?s(t.request):t._timedOut?s(t.request,"Request is aborted: timeout"):void(t.request&&4==t.request[readyState]&&(t.request.onreadystatechange=noop,succeed(t)?e(t.request):s(t.request)))}}function setHeaders(t,e){var s,r=e.headers||{};r.Accept=r.Accept||defaultHeaders.accept[e.type]||defaultHeaders.accept["*"];var i="function"==typeof FormData&&e.data instanceof FormData;e.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||i||(r[contentType]=e.contentType||defaultHeaders.contentType);for(s in r)r.hasOwnProperty(s)&&"setRequestHeader"in t&&t.setRequestHeader(s,r[s])}function setCredentials(t,e){"undefined"!=typeof e.withCredentials&&"undefined"!=typeof t.withCredentials&&(t.withCredentials=!!e.withCredentials)}function generalCallback(t){lastValue=t}function urlappend(t,e){return t+(/\?/.test(t)?"&":"?")+e}function handleJsonp(t,e,s,r){var i=uniqid++,n=t.jsonpCallback||"callback",o=t.jsonpCallbackName||reqwest.getcallbackPrefix(i),a=new RegExp("((^|\\?|&)"+n+")=([^&]+)"),u=r.match(a),l=doc.createElement("script"),h=0,d=navigator.userAgent.indexOf("MSIE 10.0")!==-1;return u?"?"===u[3]?r=r.replace(a,"$1="+o):o=u[3]:r=urlappend(r,n+"="+o),win[o]=generalCallback,l.type="text/javascript",l.src=r,l.async=!0,"undefined"==typeof l.onreadystatechange||d||(l.htmlFor=l.id="_reqwest_"+i),l.onload=l.onreadystatechange=function(){return!(l[readyState]&&"complete"!==l[readyState]&&"loaded"!==l[readyState]||h)&&(l.onload=l.onreadystatechange=null,l.onclick&&l.onclick(),e(lastValue),lastValue=void 0,head.removeChild(l),void(h=1))},head.appendChild(l),{abort:function(){l.onload=l.onreadystatechange=null,s({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(l),h=1}}}function getRequest(t,e){var s,r=this.o,i=(r.method||"GET").toUpperCase(),n="string"==typeof r?r:r.url,o=r.processData!==!1&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null,a=!1;return"jsonp"!=r.type&&"GET"!=i||!o||(n=urlappend(n,o),o=null),"jsonp"==r.type?handleJsonp(r,t,e,n):(s=r.xhr&&r.xhr(r)||xhr(r),s.open(i,n,r.async!==!1),setHeaders(s,r),setCredentials(s,r),win[xDomainRequest]&&s instanceof win[xDomainRequest]?(s.onload=t,s.onerror=e,s.onprogress=function(){},a=!0):s.onreadystatechange=handleReadyState(this,t,e),r.before&&r.before(s),a?setTimeout(function(){s.send(o)},200):s.send(o),s)}function Reqwest(t,e){this.o=t,this.fn=e,init.apply(this,arguments)}function setType(t){return t.match("json")?"json":t.match("javascript")?"js":t.match("text")?"html":t.match("xml")?"xml":void 0}function init(o,fn){function complete(t){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(t)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(t){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(t){return error(resp,"Could not parse JSON in response",t)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(t,e,s){for(t=self.request,self._responseArgs.resp=t,self._responseArgs.msg=e,self._responseArgs.t=s,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(t,e,s);complete(t)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(t,e){return new Reqwest(t,e)}function normalize(t){return t?t.replace(/\r?\n/g,"\r\n"):""}function serial(t,e){var s,r,i,n,o=t.name,a=t.tagName.toLowerCase(),u=function(t){t&&!t.disabled&&e(o,normalize(t.attributes.value&&t.attributes.value.specified?t.value:t.text))};if(!t.disabled&&o)switch(a){case"input":/reset|button|image|file/i.test(t.type)||(s=/checkbox/i.test(t.type),r=/radio/i.test(t.type),i=t.value,(!(s||r)||t.checked)&&e(o,normalize(s&&""===i?"on":i)));break;case"textarea":e(o,normalize(t.value));break;case"select":if("select-one"===t.type.toLowerCase())u(t.selectedIndex>=0?t.options[t.selectedIndex]:null);else for(n=0;t.length&&n<t.length;n++)t.options[n].selected&&u(t.options[n])}}function eachFormElement(){var t,e,s=this,r=function(t,e){var r,i,n;for(r=0;r<e.length;r++)for(n=t[byTag](e[r]),i=0;i<n.length;i++)serial(n[i],s)};for(e=0;e<arguments.length;e++)t=arguments[e],/input|select|textarea/i.test(t.tagName)&&serial(t,s),r(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var t={};return eachFormElement.apply(function(e,s){e in t?(t[e]&&!isArray(t[e])&&(t[e]=[t[e]]),t[e].push(s)):t[e]=s},arguments),t}function buildParams(t,e,s,r){var i,n,o,a=/\[\]$/;if(isArray(e))for(n=0;e&&n<e.length;n++)o=e[n],s||a.test(t)?r(t,o):buildParams(t+"["+("object"==typeof o?n:"")+"]",o,s,r);else if(e&&"[object Object]"===e.toString())for(i in e)buildParams(t+"["+i+"]",e[i],s,r);else r(t,e)}var win=window,doc=document,httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(t){if(t.crossOrigin===!0){var e=win[xmlHttpRequest]?new XMLHttpRequest:null;if(e&&"withCredentials"in e)return e;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(t){return t}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(t,e){return t=t||function(){},e=e||function(){},this._fulfilled?this._responseArgs.resp=t(this._responseArgs.resp):this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(t),this._errorHandlers.push(e)),this},always:function(t){return this._fulfilled||this._erred?t(this._responseArgs.resp):this._completeHandlers.push(t),this},fail:function(t){return this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(t),this},"catch":function(t){return this.fail(t)}},reqwest.serializeArray=function(){var t=[];return eachFormElement.apply(function(e,s){t.push({name:e,value:s})},arguments),t},reqwest.serialize=function(){if(0===arguments.length)return"";var t,e,s=Array.prototype.slice.call(arguments,0);return t=s.pop(),t&&t.nodeType&&s.push(t)&&(t=null),t&&(t=t.type),e="map"==t?serializeHash:"array"==t?reqwest.serializeArray:serializeQueryString,e.apply(null,s)},reqwest.toQueryString=function(t,e){var s,r,i=e||!1,n=[],o=encodeURIComponent,a=function(t,e){e="function"==typeof e?e():null==e?"":e,n[n.length]=o(t)+"="+o(e)};if(isArray(t))for(r=0;t&&r<t.length;r++)a(t[r].name,t[r].value);else for(s in t)t.hasOwnProperty(s)&&buildParams(s,t[s],i,a);return n.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(t,e){return t&&(t.type&&(t.method=t.type)&&delete t.type,t.dataType&&(t.type=t.dataType),t.jsonpCallback&&(t.jsonpCallbackName=t.jsonpCallback)&&delete t.jsonpCallback,t.jsonp&&(t.jsonpCallback=t.jsonp)),new Reqwest(t,e)},reqwest.ajaxSetup=function(t){t=t||{};for(var e in t)globalSetupOptions[e]=t[e]},reqwest}),function(){var t=[].slice,e=function(t,e){return function(){return t.apply(e,arguments)}},s=function(t,e){function s(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t},r={}.hasOwnProperty;!function(t,e){return"function"==typeof define&&define.amd?define(function(){return e(t)}):t.NeatComplete=e(t)}(this,function(){var r;return r={},r.addDomEvent=function(t,e,s){var r;return t.addEventListener?t.addEventListener(e,s,!1):(r=function(){return s.apply(t,arguments)},t.attachEvent("on"+e,r))},r.removeDomEvent=function(t,e,s){t.removeEventListener?t.removeEventListener(e,s,!1):t.detachEvent&&t.detachEvent("on"+e,null)},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e,s,r,i;if(null==this)throw new TypeError;if(i=Object(this),s=i.length>>>0,0===s)return-1;if(r=0,arguments.length>0&&(r=Number(arguments[1]),r!==r?r=0:0!==r&&Infinity!==r&&-Infinity!==r&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=s)return-1;for(e=r>=0?r:Math.max(s-Math.abs(r),0);e<s;){if(e in i&&i[e]===t)return e;e++}return-1}),r.Dispatch=function(){function e(){}return e.prototype.setOption=function(t,e){return this.options[t]=e,this},e.prototype.getOption=function(t){return this.options[t]},e.prototype.on=function(t,e){var s;return null==this.subs&&(this.subs={}),null==(s=this.subs)[t]&&(s[t]=[]),this.subs[t].push(e),this},e.prototype.trigger=function(){var e,s,r,i,n,o,a;if(r=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],null!=(null!=(o=this.subs)?o[r]:void 0))for(a=this.subs[r],i=0,n=a.length;i<n;i++)s=a[i],s.apply(this,e);return this},e}(),r.Widget=function(t){function i(t,s){this.element=t,this.options=null!=s?s:{},this._onPaste=e(this._onPaste,this),this._onBlur=e(this._onBlur,this),this._onKeyDown=e(this._onKeyDown,this),this._onKeyPress=e(this._onKeyPress,this),this._onFocus=e(this._onFocus,this),this.enabled=!0,this.searchQueued=!1,this.element.setAttribute("autocomplete","off"),this.services=[],this._applyDefaults(),null==this.getOption("container")&&this.setOption("container",window.document.body),this._addListeners(),this.output=document.createElement("ul"),this.output.className=this.options.list_class,this._applyStyle("display","none"),this._applyStyle("position",this.options.position),this.options.container.appendChild(this.output)}return s(i,t),i.prototype.defaults={max_results:10,list_class:"nc_list",item_class:"nc_item",hover_class:"nc_hover",footer_class:"nc_footer",empty_class:"nc_empty",error_class:"nc_error",position:"absolute",timeout:400,ignore_returns:!0},i.prototype.addService=function(t,e,s){var i;return null==s&&(s={}),this.services.push(i=new r.Service(this,t,e,s)),i},i.prototype.disable=function(){return this.enabled=!1,this},i.prototype.enable=function(){return this.enabled=!0,this},i.prototype.destroy=function(){document.body.removeChild(this.output),this.element.removeAttribute("autocomplete")},i.prototype._applyDefaults=function(){var t,e,s,r;e=this.defaults,s=[];for(t in e)r=e[t],null==this.getOption(t)?s.push(this.setOption(t,r)):s.push(void 0);return s},i.prototype._addListeners=function(){return r.addDomEvent(this.element,"focus",this._onFocus),r.addDomEvent(this.element,"keypress",this._onKeyPress),r.addDomEvent(this.element,"keydown",this._onKeyDown),r.addDomEvent(this.element,"blur",this._onBlur),r.addDomEvent(this.element,"paste",this._onPaste)},i.prototype._removeListeners=function(){return r.removeDomEvent(this.element,"focus",this._onFocus),r.removeDomEvent(this.element,"keypress",this._onKeyPress),r.removeDomEvent(this.element,"keydown",this._onKeyDown),r.removeDomEvent(this.element,"blur",this._onBlur),r.removeDomEvent(this.element,"paste",this._onPaste)},i.prototype._onFocus=function(){return this.focused=!0},i.prototype._onKeyPress=function(t){var e,s,r;if(s=t.which||t.keyCode,this.visible&&13===s)return null!=(r=this.highlighted)&&r.selectItem(),e=this.getOption("ignore_returns"),e&&t.preventDefault?t.preventDefault():e&&(t.returnValue=!1),this.highlighted=null},i.prototype._onKeyDown=function(t){var e,s;switch(e=t.which||t.keyCode){case 38:return this.visible&&this._moveHighlight(-1),!1;case 40:return this.visible&&this._moveHighlight(1),!1;case 9:if(this.visible)return null!=(s=this.highlighted)?s.selectItem():void 0;break;case 27:return this._hideResults();case 37:case 39:case 13:break;default:return this._getSuggestionsWithTimeout()}},i.prototype._onBlur=function(){if(!this.mouseDownOnSelect)return this.focused=!1,this._hideResults()},i.prototype._onPaste=function(){return this._getSuggestionsWithTimeout()},i.prototype._moveHighlight=function(t){var e,s,r;return e=null!=this.highlighted?this.results.indexOf(this.highlighted):-1,null!=(s=this.highlighted)&&s.unhighlight(),e+=t,e<-1?e=this.results.length-1:e>=this.results.length&&(e=-1),null!=(r=this.results[e])&&r.highlight(),this.element.value=null!=this.highlighted?this.highlighted.value:this._val},i.prototype._getSuggestionsWithTimeout=function(){return null!=this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(t){return function(){return t._getSuggestions()}}(this),this.options.timeout)},i.prototype._getSuggestions=function(){var t,e,s,r,i;if(this.enabled){if(!this._servicesReady())return void(this.searchQueued=!0);if(this._val=this.element.value,this.error_content=null,""!==this._val){for(s=this.services,r=[],t=0,e=s.length;t<e;t++)i=s[t],r.push(i.search(this._val));return r}return this._hideResults()}},i.prototype._applyStyle=function(t,e){return this.output.style[t]=e},i.prototype._getPosition=function(){var t,e;for(e=this.element,t={top:e.offsetTop+e.offsetHeight,left:e.offsetLeft};e=e.offsetParent;)t.top+=e.offsetTop,t.left+=e.offsetLeft;return t},i.prototype._hideResults=function(){var t,e,s,r,i;for(this.visible=!1,this._applyStyle("display","none"),this.results=[],s=this.services,r=[],t=0,e=s.length;t<e;t++)i=s[t],r.push(i.results=[]);return r},i.prototype._displayResults=function(){var t;return this.visible=!0,t=this._getPosition(),this.options.container===document.body&&(this._applyStyle("left",t.left+"px"),this._applyStyle("top",t.top+"px")),this._applyStyle("display","block")},i.prototype._renderItem=function(t,e){var s;return s=document.createElement("li"),s.innerHTML=t,null!=e&&(s.className=e),r.addDomEvent(s,"mousedown",function(t){return function(){return t.mouseDownOnSelect=!0}}(this)),r.addDomEvent(s,"mouseup",function(t){return function(){return t.mouseDownOnSelect=!1}}(this)),s},i.prototype._renderFooter=function(){return this._renderItem(this.options.footer_content,this.options.footer_class)},i.prototype._renderEmpty=function(){return this._renderItem(this.options.empty_content,this.options.empty_class)},i.prototype._servicesReady=function(){var t,e,s,r,i;for(i=[],s=this.services,t=0,e=s.length;t<e;t++)r=s[t],i.push(r.ready());return i.indexOf(!1)<0},i.prototype.showResults=function(){var t,e,s,r,i,n,o,a,u;if(this._servicesReady()){for(this.searchQueued&&(this._getSuggestions(),this.searchQueued=!1),this.results=[],this.output.innerHTML="",n=this.services,e=0,r=n.length;e<r;e++)u=n[e],this.results=this.results.concat(u.results);if(this.results.length){for(this.results=this.results.sort(function(t,e){return e.score-t.score}),this.results=this.results.slice(0,+(this.getOption("max_results")-1)+1||9e9),o=this.results,s=0,i=o.length;s<i;s++)a=o[s],this.output.appendChild(a.render());null!=this.options.footer_content&&""!==(t=this._renderFooter())&&this.output.appendChild(t),this._displayResults()}else this.error_content?(this.output.appendChild(this._renderItem(this.error_content,this.options.error_class)),this._displayResults()):(null!=this.options.empty_content?(this.output.appendChild(this._renderEmpty()),this._displayResults()):this._hideResults(),this.trigger("results:empty"));this.trigger("results:update")}},i.prototype.selectHighlighted=function(){this.element.value=this.highlighted.value,this._hideResults(),this.trigger("result:select",this.highlighted.value,this.highlighted.data)},i}(r.Dispatch),r.Service=function(t){function i(t,s,r,i){this.widget=t,this.name=s,this.search_fn=r,this.options=null!=i?i:{},this._response=e(this._response,this),this.ready=e(this.ready,this),this.results=[],this._ready=!0,this.response=function(t){return function(){return t._response.apply(t,arguments)}}(this)}return s(i,t),i.prototype.ready=function(){return this._ready},i.prototype.search=function(t){return this.last_query=t,this._ready=!1,this.search_fn(t,this.response)},i.prototype._response=function(t,e){var s,i,n;if(this.results=[],this.last_query===t){for(this.results=[],i=0,n=e.length;i<n;i++)s=e[i],this.results.push(new r._Result(this,s));return this._ready=!0,this.widget.showResults()}},i}(r.Dispatch),r._Result=function(){function t(t,e){var s,r,i,n;this.service=t,this.options=e,this.widget=this.service.widget,this.renderer=this.service.options.renderer||this.widget.options.renderer,this.value=null!=(s=this.options)?s.value:void 0,this.score=(null!=(r=this.options)?r.score:void 0)||0,this.identifier=null!=(i=this.options)?i.identifier:void 0,this.data=(null!=(n=this.options)?n.data:void 0)||{}}return t.prototype.render=function(){return this.li=document.createElement("li"),this.li.innerHTML=null!=this.renderer?this.renderer(this.value,this.data):this.value,this.li.className=this.widget.options.item_class,this.addEvents(),this.li},t.prototype.addEvents=function(){return r.addDomEvent(this.li,"click",function(t){return function(e){return t.selectItem(),e.preventDefault?e.preventDefault():e.returnValue=!1}}(this)),r.addDomEvent(this.li,"mouseover",function(t){return function(){return t.highlight()}}(this)),r.addDomEvent(this.li,"mouseout",function(t){return function(){return t.unhighlight()}}(this)),r.addDomEvent(this.li,"mousedown",function(t){return function(){return t.widget.mouseDownOnSelect=!0}}(this)),r.addDomEvent(this.li,"mouseup",function(t){return function(){return t.widget.mouseDownOnSelect=!1}}(this))},t.prototype.selectItem=function(){return this.service.trigger("result:select",this.value,this.data),this.widget.highlighted=this,this.widget.selectHighlighted()},t.prototype.highlight=function(){var t;return null!=(t=this.widget.highlighted)&&t.unhighlight(),this.li.className=this.li.className+" "+this.widget.options.hover_class,this.widget.highlighted=this},t.prototype.unhighlight=function(){return this.widget.highlighted=null,this.li.className=this.li.className.replace(new RegExp(this.widget.options.hover_class,"gi"),"")},t}(),r})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function r(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},s={}.hasOwnProperty;!function(t,e){return"function"==typeof define&&define.amd?define(["reqwest","neat_complete"],function(s,r){return e(t,s,r)}):t.AddressFinder=e(t,window.reqwest,window.NeatComplete)}(this,function(s,r,i){var n;return n={},n.SERVER="https://api.addressfinder.io",n.AU_BROCHURE="https://addressfinder.com.au",n.NZ_BROCHURE="https://addressfinder.nz",n.CSS="/assets/v3.css",n.VERSION="11.10.0",n.WIDGET_VERSION="3.10.0",n.KEYPRESS_INTERVAL=50,n.MIN_SEARCH_CHARS=2,n.MAX_QUERY_TIME=3e3,n.objParams=function(t){var e,s,r;return s=function(){var s;s=[];for(e in t)r=t[e],s.push(e+"="+r);return s}(),s.join("&")},n.Widget=function(s){function i(e,s,o,a){var u;this.element=e,this.api_key=s,this.country_code=o,this.options=null!=a?a:{},this._generateFooter=t(this._generateFooter,this),this.addServices=t(this.addServices,this),this.checkSuppliedParameters=t(this.checkSuppliedParameters,this),this.setOption=t(this.setOption,this),this.checkSuppliedParameters()&&(i.__super__.constructor.call(this,this.element,this.options),this.paid=!0,this.reqwest=r,this.options.manual_style||this._addCSS(),this._applyStyle("position",this.options.position),this.country=new n.Country(this.country_code),(u=this.options).empty_content||(u.empty_content="No addresses were found. This could be a new address, or you may need to check the spelling. <a target='_blank' alt='Missing Addresses Documentation' href="+this.country.brochureUrl()+"/docs/missing_addresses>Learn more</a>"),null==this.options.address_params.highlight&&(this.options.address_params.highlight=1),null==this.options.location_params.highlight&&(this.options.location_params.highlight=1),null==this.options.points_of_interest_params.highlight&&(this.options.points_of_interest_params.highlight=1),this.country.is_nz&&null==this.options.address_params.strict&&(this.options.address_params.strict=2),this.sessionID=this.generateSessionID(),this.addServices(),this._generateFooter())}return e(i,s),i.prototype.defaults={max_results:10,list_class:"af_list",item_class:"af_item",hover_class:"af_hover",footer_class:"af_footer",empty_class:"af_empty",error_class:"af_error",manual_style:!1,show_addresses:!0,show_locations:!1,position:"absolute",ignore_returns:!0,byline:!0,canonical:!0,timeout:n.KEYPRESS_INTERVAL,address_params:{},location_params:{},points_of_interest_params:{},allow_null_suburb:!0,demo:!1},i.prototype.setOption=function(t,e){return"address_params"===t||"location_params"===t?this.options[t]=this._extend(this.getOption(t),e):i.__super__.setOption.apply(this,arguments)},i.prototype.generateSessionID=function(){var t,e,s,r,i,n;for(n=[],i=0;i<256;)n[i]=(i<16?"0":"")+i.toString(16),i++;return t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n[255&t]+n[t>>8&255]+n[t>>16&255]+n[t>>24&255]+"-"+n[255&e]+n[e>>8&255]+"-"+n[e>>16&15|64]+n[e>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]},i.prototype.checkSuppliedParameters=function(){var t;return this.element?this.api_key?this.country_code?"AU"!==(t=this.country_code)&&"au"!==t&&"NZ"!==t&&"nz"!==t?(this.logError("Parameter country_code contains an invalid value. Check your call to the AddressFinder.Widget constructor."),!1):!("container"in this.options&&!this.options.container)||(this.logError("Option 'container' was supplied, but the value is null. Check your call to the AddressFinder.Widget constructor."),!1):(this.logError("Parameter country_code was null. Check your call to the AddressFinder.Widget constructor."),!1):(this.logError("Parameter api_key was null. Check your call to the AddressFinder.Widget constructor."),!1):(this.logError("Input element was null. Check your call to the AddressFinder.Widget constructor."),!1)},i.prototype.addServices=function(){if(this.options.show_addresses&&this.services.push(this.country.createAddressService(this,{})),this.options.show_locations&&this.services.push(this.country.createLocationService(this,{})),this.options.show_points_of_interest)return this.services.push(this.country.createPointsOfInterestService(this,{}))},i.prototype.logError=function(t){return"undefined"!=typeof console&&null!==console?console.error(t):void 0},i.prototype.addService=function(t,e,s){var r;return null==s&&(s={}),this.services.push(r=new n.Service(this,t,e,s)),r},i.prototype.showResults=function(){var t;return(t=this.options).footer_content||(t.footer_content=""),i.__super__.showResults.apply(this,arguments)},i.prototype._extend=function(t,e){var s;for(s in t)e.hasOwnProperty(s)||(e[s]=t[s]);return e},i.prototype._addCSS=function(){var t;return t=document.createElement("link"),t.type="text/css",t.rel="stylesheet",t.href=n.SERVER+n.CSS,t.media="screen",null!=document.createStyleSheet?document.createStyleSheet(n.SERVER+n.CSS):document.getElementsByTagName("head")[0].appendChild(t)},i.prototype._random=function(t){return 100*Math.random()<=t},i.prototype._generateFooter=function(){return this._random_byline_url=this._random(50)?this.country.brochureUrl()+"/features/address-autocomplete-field/":""+this.country.brochureUrl(),this._random_byline_content=this._random(50)?"<a href='"+this._random_byline_url+"?utm_source=addressfinder-widget-v3&utm_campaign=widget-free&utm_term=widget&utm_content=Powered%20for%20free%20by%20AddressFinder' target='_blank' >Powered for free by <span>AddressFinder</span></a>":"<a href='"+this._random_byline_url+"?utm_source=addressfinder-widget-v3&utm_campaign=widget-free&utm_term=widget&utm_content=Get%20AddressFinder%20for%20free' target='_blank' >Get <span>AddressFinder</span> for free</a>"},i.prototype._renderFooter=function(){var t;return this.demo?(t=this._renderItem("You are using the <strong style='display:block'> <a href='"+this.country.brochureUrl()+"?utm_source=addressfinder-widget-v3&utm_campaign=widget-demo&utm_term=widget&utm_content=You%20are%20using%20the%20AddressFinder%20demo%20key' target='_blank' style='color:rgb(40,108,141) !important;text-decoration:none !important'>AddressFinder</a> demo key </strong> <a href='"+this.country.signupUrl()+"?utm_source=addressfinder-widget-v3&utm_campaign=widget-demo&utm_term=widget&utm_content=Get%20a%20free%20key' target='_blank' style='display:block;margin:10px auto 0;background-color:#cf6d66;color:#fff !important;text-transform:uppercase;text-decoration:none !important;padding:15px 8px;max-width:200px;-webkit-border-radius:5px;border-radius:5px'> Get a free license key </a>"),t.style.cssText="background-color: #F0F0F0; padding: 15px; text-align: center;font-family:sans-serif;line-height:1.4;min-width:250px;display:block !important;visibility: visible !important; opacity: 1 !important; height: auto !important;",t):this.paid?this.options.footer_content?this._renderItem(this.options.footer_content,this.options.footer_class):this.options.byline?(t=this._renderItem("Powered by <a href='"+this.country.brochureUrl()+"?utm_source=addressfinder-widget-v3&utm_campaign=widget-pro&utm_term=widget&utm_content=Powered%20by%20AddressFinder' target='_blank' >AddressFinder</a>",this.options.footer_class),t.style.cssText="display: block !important; visibility: visible !important; opacity: 1 !important; height: auto !important;",t):"":(t=this._renderItem(this._random_byline_content,this.options.footer_class),t.style.cssText="display: block !important; visibility: visible !important; opacity: 1 !important; height: auto !important;",t)},i}(i.Widget),n.Service=function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return e(s,t),s}(i.Service),n.Country=function(){function e(e){this.createPointsOfInterestService=t(this.createPointsOfInterestService,this),this.createLocationService=t(this.createLocationService,this),this.createAddressService=t(this.createAddressService,this),this.id_attribute=t(this.id_attribute,this),this.namespace=t(this.namespace,this),this.is_nz=t(this.is_nz,this),this.is_valid=t(this.is_valid,this),this.country_code=e.toLowerCase()}return e.prototype.is_valid=function(){var t;return"au"===(t=this.country_code)||"nz"===t},e.prototype.is_nz=function(){return"nz"===this.country_code},e.prototype.namespace=function(){switch(this.country_code){case"au":return"api/au";case"nz":return"api/nz"}},e.prototype.id_attribute=function(){switch(this.country_code){case"au":return"id";case"nz":return"pxid"}},e.prototype.createAddressService=function(t,e){switch(this.country_code){case"au":return new n._AUAddressService(t,e);case"nz":return new n._NZAddressService(t,e)}},e.prototype.createLocationService=function(t,e){switch(this.country_code){case"nz":return new n._NZLocationService(t,e);case"au":return new n._AULocationService(t,e)}},e.prototype.createPointsOfInterestService=function(t,e){switch(this.country_code){case"nz":return new n._NZPointsOfInterestService(t,e)}},e.prototype.brochureUrl=function(){switch(this.country_code){case"au":return n.AU_BROCHURE;case"nz":return n.NZ_BROCHURE}},e.prototype.signupUrl=function(){return"https://portal.addressfinder.io/signup/"+this.country_code+"/free1"},e}(),n._AFService=function(s){function r(e,s){this.widget=e,this.options=null!=s?s:{},this.searchSuccess=t(this.searchSuccess,this),this._unlockSearchRequests=t(this._unlockSearchRequests,this),this._lockSearchRequests=t(this._lockSearchRequests,this),this.ready=t(this.ready,this),this.results=[],this._ready=!0,this._resume_requests_timer=null}return e(r,s),r.prototype.ready=function(){return this._ready},r.prototype._lockSearchRequests=function(){return this._ready=!1,this._resume_requests_timer=setTimeout(function(t){return function(){return t._ready=!0}}(this),n.MAX_QUERY_TIME)},r.prototype._unlockSearchRequests=function(){return null!=this._resume_requests_timer&&clearTimeout(this._resume_requests_timer),this._ready=!0},r.prototype.search=function(t){var e;if(t.length>=n.MIN_SEARCH_CHARS)return this.widget.error=null,this.last_query=t,this._lockSearchRequests(),e=n.objParams({q:encodeURIComponent(t),key:this.widget.api_key,format:"json",max:this.widget.options.max_results,wv:n.WIDGET_VERSION,session:this.widget.sessionID}),this.extraParams()&&(e+="&"+this.extraParams()),this.widget.reqwest({url:this.baseURL+"?"+e,type:"jsonp",jsonpCallback:"callback",success:this.searchSuccess})},r.prototype.searchSuccess=function(t){var e,s,r,i,n,o;for(this.results=[],i=t.completions.slice(0,+this.widget.options.max_results+1||9e9),e=s=0,r=i.length;s<r;e=++s)n=i[e],o=this.widget.options.max_results-e+this.sort_value,this.results.push(this.createResult(this,{value:n[this.fullAddressAttribute],score:o,data:n}));return this.widget.paid=t.paid,this.widget.demo=t.demo,null!=t.error_code&&(this.widget.error_content="Error: <a href='"+this.widget.country.brochureUrl()+"/docs/api_errors#error_"+t.error_code+"' target='_blank'>"+t.message+"</a>"),this._unlockSearchRequests(),this.widget.showResults()},r}(i.Dispatch),n._Result=function(s){function r(){return this.selectItemSuccess=t(this.selectItemSuccess,this),this.selectItem=t(this.selectItem,this),this.record_id=t(this.record_id,this),r.__super__.constructor.apply(this,arguments)}return e(r,s),r.prototype.record_id=function(){return this.data[this.service.identifierAttribute]},r.prototype.selectItem=function(){var t;if(null!=this.data&&null!=this.data[this.service.identifierAttribute]&&!this.widget.info_loading)return this.widget.info_loading=!0,this.populateValue(),this.service.trigger("result:select:pre",this.value,this.data),t={format:"json",key:this.widget.api_key,wv:n.WIDGET_VERSION,session:this.widget.sessionID},t[this.service.identifierAttribute]=this.record_id(),this.widget.reqwest({url:this.service.baseURL+"/info",data:t,type:"jsonp",jsonpCallback:"callback",success:this.selectItemSuccess})},r.prototype.selectItemSuccess=function(t){return this.data=t,this.service.trigger("result:select",this.value,this.data),this.widget.highlighted=this,this.widget.selectHighlighted(),this.widget.info_loading=!1,this.widget.highlighted=null},r}(i._Result),n.HighlightSearchTerms=function(){function e(e,s){this.fullAddress=e,this.queryString=s,this.format=t(this.format,this),this.applyMask=t(this.applyMask,this),this.populateMask=t(this.populateMask,this),this.queryElements=t(this.queryElements,this)}return e.prototype.queryElements=function(){return this.queryString.match(/[a-z0-9]+/gi)},e.prototype.populateMask=function(){var t,e,s,r,i,n,o,a,u,l;for(this.highlightMask=Array(this.fullAddress.length),o=this.queryElements(),s=0,i=o.length;s<i;s++)for(t=o[s],l=new RegExp(t,"ig");null!==(n=l.exec(this.fullAddress));)for(e=r=a=n.index,
u=n.index+t.length;a<=u?r<u:r>u;e=a<=u?++r:--r)this.highlightMask[e]=!0;return this.highlightMask},e.prototype.applyMask=function(){var t,e,s,r,i;for(this.highlightedAddress="",e=!1,s=r=0,i=this.fullAddress.length;0<=i?r<i:r>i;s=0<=i?++r:--r)t=this.fullAddress.charAt(s),this.highlightMask[s]?e?this.highlightedAddress+=t:(e=!0,this.highlightedAddress+='<span class="af_hl">'+t):e?(e=!1,this.highlightedAddress+="</span>"+t):this.highlightedAddress+=t;if(e)return this.highlightedAddress+="</span>"},e.prototype.format=function(){return this.populateMask(),this.applyMask(),this.highlightedAddress},e}(),n._NZAddressService=function(s){function r(e,s){null==s&&(s={}),this.createResult=t(this.createResult,this),this.highlightRenderer=t(this.highlightRenderer,this),r.__super__.constructor.call(this,e,s),this.on("result:select:pre",function(t){return function(e,s){return t.widget.trigger("address:select:pre",e,s)}}(this)),this.on("result:select",function(t){return function(e,s){return t.widget.trigger("address:select",e,s)}}(this)),"1"!==this.widget.getOption("address_params").highlight&&1!==this.widget.getOption("address_params").highlight||(this.options.renderer=this.highlightRenderer)}return e(r,s),r.prototype.search_type="address",r.prototype.sort_value=-1e3,r.prototype.baseURL=n.SERVER+"/api/nz/address",r.prototype.identifierAttribute="pxid",r.prototype.fullAddressAttribute="a",r.prototype.highlightRenderer=function(t,e){return e.highlighted_a},r.prototype.extraParams=function(){if(null!=this.widget.getOption("address_params"))return n.objParams(this.widget.getOption("address_params"))},r.prototype.createResult=function(t,e){return new n._NZAddressResult(t,e)},r}(n._AFService),n._NZAddressResult=function(s){function r(){return this.selectItemSuccess=t(this.selectItemSuccess,this),this.populateValue=t(this.populateValue,this),r.__super__.constructor.apply(this,arguments)}return e(r,s),r.prototype.populateValue=function(){return this.value=this.data.a},r.prototype.selectItemSuccess=function(t){return this.widget.getOption("allow_null_suburb")&&t.city===t.suburb&&(t.suburb=null),r.__super__.selectItemSuccess.apply(this,arguments)},r}(n._Result),n._NZLocationService=function(s){function r(e,s){null==s&&(s={}),this.createResult=t(this.createResult,this),this.highlightRenderer=t(this.highlightRenderer,this),r.__super__.constructor.call(this,e,s),this.on("result:select:pre",function(t){return function(e,s){return t.widget.trigger("location:select:pre",e,s)}}(this)),this.on("result:select",function(t){return function(e,s){return t.widget.trigger("location:select",e,s)}}(this)),"1"!==this.widget.getOption("location_params").highlight&&1!==this.widget.getOption("location_params").highlight||(this.options.renderer=this.highlightRenderer)}return e(r,s),r.prototype.search_type="location",r.prototype.sort_value=-100,r.prototype.baseURL=n.SERVER+"/api/nz/location",r.prototype.identifierAttribute="pxid",r.prototype.fullAddressAttribute="a",r.prototype.highlightRenderer=function(t,e){return void 0===e.highlighted_a?new n.HighlightSearchTerms(t,this.last_query).format():e.highlighted_a},r.prototype.extraParams=function(){if(null!=this.widget.getOption("location_params"))return n.objParams(this.widget.getOption("location_params"))},r.prototype.createResult=function(t,e){return new n._NZLocationResult(t,e)},r}(n._AFService),n._NZLocationResult=function(s){function r(){return this.populateValue=t(this.populateValue,this),r.__super__.constructor.apply(this,arguments)}return e(r,s),r.prototype.populateValue=function(){return this.value=this.data.a},r}(n._Result),n._NZPointsOfInterestService=function(s){function r(e,s){null==s&&(s={}),this.createResult=t(this.createResult,this),this.highlightRenderer=t(this.highlightRenderer,this),r.__super__.constructor.call(this,e,s),this.on("result:select:pre",function(t){return function(e,s){return t.widget.trigger("points_of_interest:select:pre",e,s)}}(this)),this.on("result:select",function(t){return function(e,s){return t.widget.trigger("points_of_interest:select",e,s)}}(this)),"1"!==this.widget.getOption("points_of_interest_params").highlight&&1!==this.widget.getOption("points_of_interest_params").highlight||(this.options.renderer=this.highlightRenderer)}return e(r,s),r.prototype.search_type="points_of_interest",r.prototype.sort_value=-10,r.prototype.baseURL=n.SERVER+"/api/nz/points_of_interest",r.prototype.identifierAttribute="id",r.prototype.fullAddressAttribute="name_and_address",r.prototype.highlightRenderer=function(t,e){return e.highlighted_name_and_address},r.prototype.extraParams=function(){if(null!=this.widget.getOption("points_of_interest_params"))return n.objParams(this.widget.getOption("points_of_interest_params"))},r.prototype.createResult=function(t,e){return new n._NZPointsOfInterestResult(t,e)},r}(n._AFService),n._NZPointsOfInterestResult=function(s){function r(){return this.populateValue=t(this.populateValue,this),r.__super__.constructor.apply(this,arguments)}return e(r,s),r.prototype.populateValue=function(){return this.value=this.data.name_and_address},r}(n._Result),n._AUAddressService=function(s){function r(e,s){null==s&&(s={}),this.createResult=t(this.createResult,this),this.highlightRenderer=t(this.highlightRenderer,this),r.__super__.constructor.call(this,e,s),"1"!==this.widget.getOption("address_params").highlight&&1!==this.widget.getOption("address_params").highlight||(this.options.renderer=this.highlightRenderer),this.on("result:select:pre",function(t){return function(e,s){return t.widget.trigger("address:select:pre",e,s)}}(this)),this.on("result:select",function(t){return function(e,s){return t.widget.trigger("address:select",e,s)}}(this))}return e(r,s),r.prototype.search_type="address",r.prototype.sort_value=-1e3,r.prototype.baseURL=n.SERVER+"/api/au/address",r.prototype.identifierAttribute="id",r.prototype.fullAddressAttribute="full_address",r.prototype.highlightRenderer=function(t,e){return e.highlighted_full_address},r.prototype.extraParams=function(){if(null!=this.widget.getOption("address_params"))return n.objParams(this.widget.getOption("address_params"))},r.prototype.createResult=function(t,e){return new n._AUAddressResult(t,e)},r}(n._AFService),n._AULocationService=function(s){function r(e,s){null==s&&(s={}),this.createResult=t(this.createResult,this),this.highlightRenderer=t(this.highlightRenderer,this),r.__super__.constructor.call(this,e,s),"1"!==this.widget.getOption("location_params").highlight&&1!==this.widget.getOption("location_params").highlight||(this.options.renderer=this.highlightRenderer),this.on("result:select:pre",function(t){return function(e,s){return t.widget.trigger("location:select:pre",e,s)}}(this)),this.on("result:select",function(t){return function(e,s){return t.widget.trigger("location:select",e,s)}}(this))}return e(r,s),r.prototype.search_type="location",r.prototype.sort_value=-100,r.prototype.baseURL=n.SERVER+"/api/au/location",r.prototype.identifierAttribute="id",r.prototype.fullAddressAttribute="full_location",r.prototype.highlightRenderer=function(t,e){return e.highlighted_full_location},r.prototype.extraParams=function(){if(null!=this.widget.getOption("location_params"))return n.objParams(this.widget.getOption("location_params"))},r.prototype.createResult=function(t,e){return new n._AULocationResult(t,e)},r}(n._AFService),n._AULocationResult=function(s){function r(){return this.selectItemSuccess=t(this.selectItemSuccess,this),this.populateValue=t(this.populateValue,this),this.record_id=t(this.record_id,this),r.__super__.constructor.apply(this,arguments)}return e(r,s),r.prototype.record_id=function(){return this.widget.getOption("canonical")?this.data.canonical_location_id:this.data.id},r.prototype.populateValue=function(){return this.value=this.data.full_location},r.prototype.selectItemSuccess=function(t){return this.value=t.full_location,r.__super__.selectItemSuccess.apply(this,arguments)},r}(n._Result),n._AUAddressResult=function(s){function r(){return this.selectItemSuccess=t(this.selectItemSuccess,this),this.populateValue=t(this.populateValue,this),this.record_id=t(this.record_id,this),r.__super__.constructor.apply(this,arguments)}return e(r,s),r.prototype.record_id=function(){return this.widget.getOption("canonical")?this.data.canonical_address_id:this.data.id},r.prototype.populateValue=function(){return this.value=this.data.full_address},r.prototype.selectItemSuccess=function(t){return this.value=t.full_address,r.__super__.selectItemSuccess.apply(this,arguments)},r}(n._Result),n.NZSelectedAddress=function(){function e(e,s){this.fullAddress=e,this.metaData=s,this._is_postal_address=t(this._is_postal_address,this),this._removeCitySuburbAddressLines=t(this._removeCitySuburbAddressLines,this),this._splitAddress=t(this._splitAddress,this),this.address_line_1_and_2=t(this.address_line_1_and_2,this),this.address_line_1=t(this.address_line_1,this),this.address_line_2=t(this.address_line_2,this),this.suburb=t(this.suburb,this),this.postcode=t(this.postcode,this),this.city=t(this.city,this),this.selectedAddress=this.fullAddress,this.originalAddressLines=this._splitAddress(),this.address_lines=this.originalAddressLines.slice(),this._removeCitySuburbAddressLines()}return e.prototype.city=function(){return this._is_postal_address()?this.metaData.mailtown||this.metaData.city:this.metaData.city},e.prototype.postcode=function(){return this.metaData.postcode},e.prototype.suburb=function(){var t;return t=this.metaData.post_suburb||this.metaData.suburb,this.originalAddressLines[this.originalAddressLines.length-2]===t?this.metaData.post_suburb||this.metaData.suburb:""},e.prototype.address_line_2=function(){return this.address_lines.length>1?this.address_lines[this.address_lines.length-1]:""},e.prototype.address_line_1=function(){var t;return t=this.address_lines.length>1?this.address_lines.slice(0,this.address_lines.length-1):this.address_lines.slice(0,this.address_lines.length),t.join(", ")},e.prototype.address_line_1_and_2=function(){return""===this.address_line_2()?this.address_line_1():[this.address_line_1(),this.address_line_2()].join(", ")},e.prototype._splitAddress=function(){var t,e,s,r,i,n;for(n=this.selectedAddress.split(","),i=[],t=s=0,r=n.length;s<r;t=++s)e=n[t],i.push(n[t]=n[t].replace(/^\s+|\s+$/g,""));return i},e.prototype._removeCitySuburbAddressLines=function(){if(this.address_lines[this.address_lines.length-1]===this.city()+" "+this.postcode()&&this.address_lines.pop(),this.address_lines[this.address_lines.length-1]===this.metaData.suburb)return this.address_lines.pop()},e.prototype._is_postal_address=function(){return this.fullAddress===this.metaData.postal},e}(),n})}.call(this),function(){}.call(this);